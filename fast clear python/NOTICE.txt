 This version has less understandable but faster code.
